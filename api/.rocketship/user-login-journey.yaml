name: "User Login Journey"
vars:
  base_url: "https://httpbin.org"

tests:
  - name: "User logs in with username and password"
    steps:
      - name: "Log login attempt"
        plugin: "log"
        config:
          message: "User attempting login with credentials"
      - name: "User submits login credentials"
        plugin: "http"
        config:
          method: "GET"
          url: "{{ .vars.base_url }}/basic-auth/testuser/testpass"
          headers:
            Authorization: "Basic dGVzdHVzZXI6dGVzdHBhc3M="
        assertions:
          - type: "status_code"
            expected: 200
          - type: "json_path"
            path: ".authenticated"
            expected: true

  - name: "User fails login with wrong password"
    steps:
      - name: "User submits incorrect credentials"
        plugin: "http"
        config:
          method: "GET"
          url: "{{ .vars.base_url }}/basic-auth/testuser/wrongpass"
          headers:
            Authorization: "Basic dGVzdHVzZXI6d3Jvbmdwdw=="
        assertions:
          - type: "status_code"
            expected: 401

  - name: "User accesses protected dashboard"
    steps:
      - name: "User authenticates with session token"
        plugin: "http"
        config:
          method: "GET"
          url: "{{ .vars.base_url }}/bearer"
          headers:
            Authorization: "Bearer my-test-token-123"
        assertions:
          - type: "status_code"
            expected: 200
          - type: "json_path"
            path: ".authenticated"
            expected: true
